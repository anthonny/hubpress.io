<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>How I use Meteor, Elm and Tailwindcss together</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="How I use Meteor, Elm and Tailwindcss together">
    <meta name="twitter:description" content="">

    <meta property="og:url" content="http://anthonnyquerouil.me">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How I use Meteor, Elm and Tailwindcss together">
    <meta property="og:description" content="">
    <meta property="og:site_name" content="Anthonny Qu√©rouil">

    <meta itemprop="name" content="How I use Meteor, Elm and Tailwindcss together">
    <meta itemprop="description" content="">

    <meta name="twitter:site" content="@yourblogtwitter">
    
    <meta name="twitter:creator" content="@yourtwitter">
    
    <meta property="article:author" content="https://www.facebook.com/yourprofile">
    
    <meta property="article:publisher" content="https://www.facebook.com/yourblogprofile">
    
    <meta property="fb:admins" content="">
    
    <meta name="google-site-verification" content="">
    
    <link rel="author" href="https://plus.google.com/yourprofile">
    
    <meta name="theme-color" content="">

    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link href="//fonts.googleapis.com/" rel="dns-prefetch">
    <link href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400&subset=latin,latin-ext" rel="stylesheet">

    <link rel="stylesheet" href="//anthonnyquerouil.me/themes/ghostium/assets/css/main.min.css?v=1592393711943">
    <link rel="stylesheet" href="//anthonnyquerouil.me/themes/ghostium/assets/css/asciidoctor-foundation.css?v=1592393711943"/>

    <script type="text/javascript">
      var ga_ua = 'UA-XXXXX-X';
      
      var disqus_shortname = 'example';
      
      var enable_pjax = true;

      // Pace Options
      // ==============
      window.paceOptions = {
        catchupTime: 100,
        minTime: 100,
        elements: false,
        restartOnRequestAfter: 500,
        startOnPageLoad: false
      }

      // Ghostium Globals
      // ==============
      window.GHOSTIUM = {};
      GHOSTIUM.haveGA = typeof ga_ua !== 'undefined' && ga_ua !== 'UA-XXXXX-X';
      GHOSTIUM.haveDisqus = typeof disqus_shortname !== 'undefined' && disqus_shortname !== 'example';
      GHOSTIUM.enablePjax = typeof enable_pjax !== 'undefined' ? enable_pjax : true;
    </script>

    <script src="//anthonnyquerouil.me/themes/ghostium/assets/js/head-scripts.min.js?v=1592393711943"></script>

    <link rel="canonical" href="http://anthonnyquerouil.me/2020/06/17/how-i-use-meteor-elm-and-tailwindcss-together.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Anthonny Qu√©rouil" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="How I use Meteor, Elm and Tailwindcss together" />
    <meta property="og:description" content="I have worked with Elm last year and honestly it was an great experience. I really liked it and I would like to use Elm in all my new projects. But I also like Meteor and three weeks ago I started using it again. I discovered Meteor in 2015, I" />
    <meta property="og:url" content="http://anthonnyquerouil.me/2020/06/17/how-i-use-meteor-elm-and-tailwindcss-together.html" />
    <meta property="article:published_time" content="2020-06-17T00:00:00.000Z" />
    <meta property="article:tag" content="meteor" />
    <meta property="article:tag" content="elm" />
    <meta property="article:tag" content="parcel" />
    <meta property="article:tag" content="tailwindcss" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="How I use Meteor, Elm and Tailwindcss together" />
    <meta name="twitter:description" content="I have worked with Elm last year and honestly it was an great experience. I really liked it and I would like to use Elm in all my new projects. But I also like Meteor and three weeks ago I started using it again. I discovered Meteor in 2015, I" />
    <meta name="twitter:url" content="http://anthonnyquerouil.me/2020/06/17/how-i-use-meteor-elm-and-tailwindcss-together.html" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Anthonny Qu√©rouil",
    "author": {
        "@type": "Person",
        "name": "Anthonny Qu√©rouil",
        "image": "https://avatars1.githubusercontent.com/u/2006548?v=4",
        "url": "http://anthonnyquerouil.me/author/anthonny/",
        "sameAs": "http://www.anthonnyquerouil.fr"
    },
    "headline": "How I use Meteor, Elm and Tailwindcss together",
    "url": "http://anthonnyquerouil.me/2020/06/17/how-i-use-meteor-elm-and-tailwindcss-together.html",
    "datePublished": "2020-06-17T00:00:00.000Z",
    "keywords": "meteor, elm, parcel, tailwindcss",
    "description": "I have worked with Elm last year and honestly it was an great experience. I really liked it and I would like to use Elm in all my new projects. But I also like Meteor and three weeks ago I started using it again. I discovered Meteor in 2015, I"
}
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Anthonny Qu√©rouil" href="http://anthonnyquerouil.me/rss/" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism-okaidia.min.css">
    
        <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
  </head>
  <body class="post-template tag-meteor tag-elm tag-parcel tag-tailwindcss">

    <button data-action="open-drawer" id="drawer-button" class="drawer-button"><i class="fa fa-bars"></i></button>
    <nav tabindex="-1" class="drawer">
      <div class="drawer-container">
        <!--.drawer-search(role="search")-->
        <ul role="navigation" class="drawer-list">
          
          <li class="drawer-list-item">
            <a href="/" data-pjax>
              <i class="fa fa-home"></i>Home
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="http://anthonnyquerouil.me/rss/">
              <i class="fa fa-rss"></i>Subscribe to Feed
            </a>
          </li>
          <li class="drawer-list-divider"></li>
          <li class="drawer-list-item drawer-list-title">
            Follow me
          </li>
          
          
          <li class="drawer-list-item">
            <a href="https://twitter.com/anthonny_q" title="Twitter" target="_blank">
              <i class="fa fa-twitter"></i>Twitter
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="https://github.com/anthonny" title="Github" target="_blank">
              <i class="fa fa-github"></i>Github
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="https://plus.google.com/u/0/+AnthonnyQuerouil" title="Google+" target="_blank">
              <i class="fa fa-google-plus"></i>Google+
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="http://fr.linkedin.com/in/anthonnyquerouil/" title="LinkedIn" target="_blank">
              <i class="fa fa-linkedin"></i>LinkedIn
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="https://www.paypal.me/anthonny" title="PayPal.me" target="_blank">
              <i class="fa fa-paypal">
                <svg viewBox="0 0 256 302" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid">
                  <g>
                    <path d="M217.168476,23.5070146 C203.234077,7.62479651 178.045612,0.815753338 145.823355,0.815753338 L52.3030619,0.815753338 C45.7104431,0.815753338 40.1083819,5.6103852 39.0762042,12.1114399 L0.136468302,259.076601 C-0.637664968,263.946149 3.13311322,268.357876 8.06925331,268.357876 L65.804612,268.357876 L80.3050438,176.385849 L79.8555471,179.265958 C80.8877248,172.764903 86.4481659,167.970272 93.0324607,167.970272 L120.46841,167.970272 C174.366398,167.970272 216.569147,146.078116 228.897012,82.7490197 C229.263268,80.8761167 229.579581,79.0531577 229.854273,77.2718188 C228.297683,76.4477414 228.297683,76.4477414 229.854273,77.2718188 C233.525163,53.8646924 229.829301,37.9325302 217.168476,23.5070146" fill="#d3d3d3"></path>
                    <path d="M102.396976,68.8395929 C103.936919,68.1070797 105.651665,67.699203 107.449652,67.699203 L180.767565,67.699203 C189.449511,67.699203 197.548776,68.265236 204.948824,69.4555699 C207.071448,69.7968545 209.127479,70.1880831 211.125242,70.6375799 C213.123006,71.0787526 215.062501,71.5781934 216.943728,72.1275783 C217.884341,72.4022708 218.808307,72.6852872 219.715624,72.9849517 C223.353218,74.2002577 226.741092,75.61534 229.854273,77.2718188 C233.525163,53.8563683 229.829301,37.9325302 217.168476,23.5070146 C203.225753,7.62479651 178.045612,0.815753338 145.823355,0.815753338 L52.2947379,0.815753338 C45.7104431,0.815753338 40.1083819,5.6103852 39.0762042,12.1114399 L0.136468302,259.068277 C-0.637664968,263.946149 3.13311322,268.349552 8.0609293,268.349552 L65.804612,268.349552 L95.8875974,77.5798073 C96.5035744,73.6675208 99.0174265,70.4627756 102.396976,68.8395929 Z" fill="#d3d3d3"></path>
                    <path d="M228.897012,82.7490197 C216.569147,146.069792 174.366398,167.970272 120.46841,167.970272 L93.0241367,167.970272 C86.4398419,167.970272 80.8794007,172.764903 79.8555471,179.265958 L61.8174095,293.621258 C61.1431644,297.883153 64.4394738,301.745495 68.7513129,301.745495 L117.421821,301.745495 C123.182038,301.745495 128.084882,297.550192 128.983876,291.864891 L129.458344,289.384335 L138.631407,231.249423 L139.222412,228.036354 C140.121406,222.351053 145.02425,218.15575 150.784467,218.15575 L158.067979,218.15575 C205.215193,218.15575 242.132193,199.002194 252.920115,143.605884 C257.423406,120.456802 255.092683,101.128442 243.181019,87.5519756 C239.568397,83.4399129 235.081754,80.0437153 229.854273,77.2718188 C229.571257,79.0614817 229.263268,80.8761167 228.897012,82.7490197 L228.897012,82.7490197 Z" fill="#FFFFFF"></path>
                    <path d="M216.952052,72.1275783 C215.070825,71.5781934 213.13133,71.0787526 211.133566,70.6375799 C209.135803,70.1964071 207.071448,69.8051785 204.957148,69.4638939 C197.548776,68.265236 189.457835,67.699203 180.767565,67.699203 L107.457976,67.699203 C105.651665,67.699203 103.936919,68.1070797 102.4053,68.8479169 C99.0174265,70.4710996 96.5118984,73.6675208 95.8959214,77.5881313 L80.3133678,176.385849 L79.8638711,179.265958 C80.8877248,172.764903 86.4481659,167.970272 93.0324607,167.970272 L120.476734,167.970272 C174.374722,167.970272 216.577471,146.078116 228.905336,82.7490197 C229.271592,80.8761167 229.579581,79.0614817 229.862597,77.2718188 C226.741092,75.623664 223.361542,74.2002577 219.723948,72.9932757 C218.816631,72.6936112 217.892665,72.4022708 216.952052,72.1275783" fill="#939393"></path>
                  </g>
                </svg>
              </i>PayPal.me
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="mailto:anthonny.querouil@gmail.com" title="Email" target="_blank">
              <i class="fa fa-envelope-o"></i>Email
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="drawer-overlay"></div>
    <main id="container" role="main" class="container">
      <div class="surface">
        <div class="surface-container">
          <div data-pjax-container class="content">
            
<section class="wrapper wrapper-post">
  <div class="wrapper-container">
    <article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post post tag-meteor tag-elm tag-parcel tag-tailwindcss">
        <section class="post-container">
          <header class="post-header">
            <ul class="post-meta-list">
              <li class="post-meta-item">
                <time datetime="2020-06-17" itemprop="datePublished">
                  14 hours ago
                </time>
              </li>
                <li class="post-meta-item">
                    <a itemprop="articleSection" href="/" data-pjax>meteor</a>, 
                    <a itemprop="keywords" href="/" data-pjax>elm</a>, 
                    <a itemprop="keywords" href="/" data-pjax>parcel</a>, 
                    <a itemprop="keywords" href="/" data-pjax>tailwindcss</a> 
                </li>
              <li class="post-meta-item">
                <a href="#disqus_thread" data-disqus-identifier="">Comments</a>
              </li>
            </ul>
            <h1 itemprop="name headline" class="post-title"><a href="http://anthonnyquerouil.me/2020/06/17/how-i-use-meteor-elm-and-tailwindcss-together.html" itemprop="url" data-pjax title="How I use Meteor, Elm and Tailwindcss together">How I use Meteor, Elm and Tailwindcss together</a></h1>
            <!--h2 itemprop="about" class="post-subtitle"></h2-->
          </header>
          <aside class="post-side">
            <div class="post-author">
                <a href="http://www.anthonnyquerouil.fr" class="post-author-avatar">
                  <img src="https://avatars1.githubusercontent.com/u/2006548?v&#x3D;4" alt="Anthonny Qu√©rouil">
                </a>
              <div class="post-author-info">
                <a href="http://www.anthonnyquerouil.fr" class="post-author-name">
                  Anthonny Qu√©rouil
                </a>
                <p class="post-author-bio"></p>
              </div>
            </div>
          </aside>
          <div itemprop="articleBody" class="post-body">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>I have worked with Elm last year and honestly it was an great experience.
I really liked it and I would like to use Elm in all my new projects.
But I also like <a href="https://www.meteor.com/">Meteor</a> and three weeks ago I started using it again.
I discovered <a href="https://www.meteor.com/">Meteor</a> in 2015, I gave a talk about it (<a href="https://www.youtube.com/watch?v=AxIvfQXTqVo" class="bare">https://www.youtube.com/watch?v=AxIvfQXTqVo</a>) and it still feels like "Wow!" when you start a project.
So in this post I will explain how I make the two work together and how to add <a href="https://tailwindcss.com/">Tailwindcss</a> for the UI part (because I love <a href="https://tailwindcss.com/">Tailwindcss</a> too üòç), from scratch.
I will also explain how to link an existing project to <a href="https://www.meteor.com/">Meteor</a> with a Todo app.</p>
</div>
<hr>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_prerequisite">Prerequisite</a></li>
<li><a href="#_meteor">Meteor</a>
<ul class="sectlevel2">
<li><a href="#_install_meteor">Install Meteor</a></li>
<li><a href="#_create_a_project">Create a project</a></li>
<li><a href="#_add_typescript">Add typescript</a></li>
<li><a href="#_create_the_file_structure">Create the file structure</a></li>
<li><a href="#_checkpoint">Checkpoint</a></li>
</ul>
</li>
<li><a href="#_elm">Elm</a>
<ul class="sectlevel2">
<li><a href="#_install_parcel">Install Parcel</a></li>
<li><a href="#_create_a_meteor_package">Create a Meteor package</a></li>
<li><a href="#_create_the_app">Create the app</a></li>
<li><a href="#_the_css_main_file">The CSS main file</a></li>
<li><a href="#_the_package_mainmodule">The Package mainModule</a></li>
<li><a href="#_build_with_parcel">Build with Parcel</a></li>
<li><a href="#_add_our_package_to_meteor">Add our package to Meteor</a></li>
<li><a href="#_post_install">Post install</a></li>
</ul>
</li>
<li><a href="#_use_the_elm_application_in_our_meteor_client">Use the Elm application in our Meteor client</a>
<ul class="sectlevel2">
<li><a href="#_the_typing_is_not_good">The typing is not good</a></li>
</ul>
</li>
<li><a href="#_live_reload">Live Reload</a></li>
<li><a href="#_tailwindcss">Tailwindcss</a></li>
<li><a href="#_the_todos_application">The Todos application</a>
<ul class="sectlevel2">
<li><a href="#_update_the_main_elm">Update the Main.elm</a></li>
<li><a href="#_define_the_todos_collection_and_methods">Define the Todos collection and methods</a></li>
<li><a href="#_add_ports_to_the_elm_application">Add ports to the Elm application</a></li>
<li><a href="#_link_ports_to_meteor_methods_and_subscriptions">Link ports to Meteor.methods and subscriptions</a></li>
</ul>
</li>
<li><a href="#_conclusion">Conclusion</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisite">Prerequisite</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You only need two things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your favourite IDE (VSCode with the <a href="https://marketplace.visualstudio.com/items?itemName=Elmtooling.elm-ls-vscode">Elm extension</a> fits very well)</p>
</li>
<li>
<p>A browser</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You don&#8217;t need to install NPM, Node or Mongo.
All this stuff is already packaged in <a href="https://www.meteor.com/">Meteor</a> environment.</p>
</div>
<div class="paragraph">
<p>So to run a NPM command we will use <code>meteor npm xxx</code>, and for Mongo, we will use <code>meteor mongo</code>.</p>
</div>
<div class="paragraph">
<p>So let&#8217;s begin üòÅ</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_meteor">Meteor</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_install_meteor">Install Meteor</h3>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84738510-53981b80-afaa-11ea-8d02-cdf6c42c26c0.png" alt="84738510 53981b80 afaa 11ea 8d02 cdf6c42c26c0">
</div>
</div>
<div class="paragraph">
<p>Here are the commands to install <a href="https://www.meteor.com/">Meteor</a> on OSX/Linux and Windows
OSX / Linux</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># OSX/Linux
curl https://install.meteor.com/ | sh

# Windows
choco install meteor</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information about the installation, please refer to the official documentation here <a href="https://www.meteor.com/install" class="bare">https://www.meteor.com/install</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_project">Create a project</h3>
<div class="paragraph">
<p>Let&#8217;s start by creating an empty project</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">meteor create meteor-elm-app --bare
cd meteor-elm-app</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>--bare</code> option will create an empty project with static-html instead of blaze and without autopublish and insecure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more information about the command create, follow the link <a href="https://docs.meteor.com/commandline.html#meteorcreate" class="bare">https://docs.meteor.com/commandline.html#meteorcreate</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_add_typescript">Add typescript</h3>
<div class="paragraph">
<p>Adding Typescript is really simple.
Just run these two commands</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># under meteor-elm-app
meteor add typescript
meteor npm i -D @types/meteor @types/mocha</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a tsconfig.json under the directory <strong>meteor-elm-app</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
    "compilerOptions": {
      /* Basic Options */
      "target": "es2018",
      "module": "esNext",
      "lib": ["esnext", "dom"],
      "allowJs": true,
      "checkJs": false,
      "incremental": false,
      "noEmit": true,

      /* Strict Type-Checking Options */
      "strict": true,
      "noImplicitAny": true,
      "strictNullChecks": true,

      /* Additional Checks */
      "noUnusedLocals": true,
      "noUnusedParameters": true,
      "noImplicitReturns": false,
      "noFallthroughCasesInSwitch": false,

      /* Module Resolution Options */
      "baseUrl": ".",
      "paths": {
        /* Support absolute ~imports/* with a leading '/' */
        "/*": ["*"]
      },
      "moduleResolution": "node",
      "resolveJsonModule": true,
      "types": ["node", "mocha"],
      "esModuleInterop": true,
      "preserveSymlinks": true,
    },
    "exclude": [
      "./.meteor/**",
      "./packages/**"
    ]
  }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This configuration comes from the typescript template provided by <a href="https://www.meteor.com/">Meteor</a>.
I just removed the support of JSX.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_create_the_file_structure">Create the file structure</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We will setup a simple file structure here.
For more complex projects, you should follow the guideline provided by <a href="https://www.meteor.com/">Meteor</a> <a href="https://guide.meteor.com/structure.html#javascript-structure" class="bare">https://guide.meteor.com/structure.html#javascript-structure</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To initialise the file structure, run these commands</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># under meteor-elm-app
mkdir client server imports/api
touch client/main.html client/main.ts client/main.css server/main.ts</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your project folder should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># under meteor-elm-app
‚ùØ tree -I node_modules
.
‚îú‚îÄ‚îÄ client
‚îÇ   ‚îú‚îÄ‚îÄ main.css
‚îÇ   ‚îú‚îÄ‚îÄ main.html
‚îÇ   ‚îî‚îÄ‚îÄ main.ts
‚îú‚îÄ‚îÄ imports
‚îÇ   ‚îî‚îÄ‚îÄ api
‚îú‚îÄ‚îÄ package-lock.json
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ server
‚îÇ   ‚îî‚îÄ‚îÄ main.ts
‚îî‚îÄ‚îÄ tsconfig.json

4 directories, 7 files</code></pre>
</div>
</div>
<div class="paragraph">
<p>We will update the <strong>package.json</strong> file to define the main modules in our <a href="https://www.meteor.com/">Meteor</a> app:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"meteor": {
    "mainModule": {
        "client": "client/main.ts",
        "server": "server/main.ts"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point your <strong>package.json</strong> file should be like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "name": "meteor-elm-app",
  "private": true,
  "scripts": {
    "start": "meteor run"
  },
  "meteor": {
    "mainModule": {
      "client": "client/main.ts",
      "server": "server/main.ts"
    }
  },
  "dependencies": {
    "@babel/runtime": "^7.8.3",
    "meteor-node-stubs": "^1.0.0"
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
if you need more informations about this mainModule options, you can read the content of this pull request <a href="https://github.com/meteor/meteor/pull/9690" class="bare">https://github.com/meteor/meteor/pull/9690</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We now need to add some basic content to the <strong>main.html</strong> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;head&gt;
  &lt;title&gt;meteor-elm-app&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;div id="main"&gt;Elm app will be here&lt;/div&gt;
&lt;/body&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_checkpoint">Checkpoint</h3>
<div class="paragraph">
<p>Lets check if everything is OK before starting with Elm.
Start your <strong>meteor</strong> server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell"># under meteor-elm-app
meteor</code></pre>
</div>
</div>
<div class="paragraph">
<p>Open <a href="http://localhost:3000" class="bare">http://localhost:3000</a> on your favorite browser
You should see this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84446744-8195fc80-ac46-11ea-9da8-4fd2033898bf.png" alt="84446744 8195fc80 ac46 11ea 9da8 4fd2033898bf">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_elm">Elm</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_install_parcel">Install Parcel</h3>
<div class="paragraph">
<p>We will use <a href="https://parceljs.org/">Parcel</a> to build our Elm application and we will use the result of this build in our <a href="https://www.meteor.com/">Meteor</a> application</p>
</div>
<div class="paragraph">
<p>To install <a href="https://parceljs.org/">Parcel</a>, run this command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">meteor npm i -D parcel</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_meteor_package">Create a Meteor package</h3>
<div class="paragraph">
<p>This <a href="https://www.meteor.com/">Meteor</a> package will contain our Elm application and we will use this package inside the <a href="https://www.meteor.com/">Meteor</a> application.</p>
</div>
<div class="paragraph">
<p>We use a Package because it permits ut to isolate our Elm application from the rest of the <a href="https://www.meteor.com/">Meteor</a> context.
It is also really useful if we want to remove our Elm application or if one we don&#8217;t want to use Meteor <a href="https://www.meteor.com/">Meteor</a> anymore.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start by creating some folders:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">mkdir -p packages/elm-app/{app,dist}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>app</strong> folder will contain the sources of our Elm application (Elm, TS and CSS files).
The <strong>dist</strong> folder will contain the result of the build made by <a href="https://parceljs.org/">Parcel</a>.</p>
</div>
<div class="paragraph">
<p>Because we will build with <a href="https://parceljs.org/">Parcel</a> and not with <a href="https://www.meteor.com/">Meteor</a>, we will create a new file at the root of the <strong>meteor-elm-app</strong> called <strong>.meteorignore</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app
touch .meteorignore</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then add this line inside this new file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/packages/elm-app/app/**/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because we don&#8217;t want to push the <strong>dist</strong> and the <strong>elm-stuff</strong> folders on our repository, we will add them in the <strong>.gitignore</strong> located under the folder <strong>meteor-elm-app</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>dist
elm-stuff</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s create a <strong>package.js</strong> file in our package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app/packages/elm-app
touch package.js</code></pre>
</div>
</div>
<div class="paragraph">
<p>And add the following content in this file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">Package.describe({
    name: 'elm-app',
    version: '1.0.0',
    summary: 'elm app',
    documentation: 'add your elm app into meteor',
});

Package.onUse(function (api) {
    api.versionsFrom('1.10.2');
    api.use('modules');
    api.addFiles('dist/elm-app.css', 'client');
    api.mainModule('dist/elm-app.js', 'client');
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Package.describe</strong> says that our package:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>is called <code>elm-app</code>,</p>
</li>
<li>
<p>is in version <code>1.0.0</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Package.onUse</code> says that our package:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>is implemented to be use with <a href="https://www.meteor.com/">Meteor</a> <code>1.10.2</code>,</p>
</li>
<li>
<p>uses the <code>modules</code> package because we will use <code>import {} from ''</code>,</p>
</li>
<li>
<p>will add the <code>dist/elm-app.css</code> file in the client when it will be loaded,</p>
</li>
<li>
<p>have a main js file for this package called <code>dist/elm-app.js</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are using <strong>elm-css</strong> and if you don&#8217;t need specific css classes in your app, you can remove <code>api.addFiles('dist/elm-app.css', 'client');</code> from the <strong>package.js</strong> file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more informations about the Package.js file, see <a href="https://docs.meteor.com/api/packagejs.html" class="bare">https://docs.meteor.com/api/packagejs.html</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_create_the_app">Create the app</h3>
<div class="paragraph">
<p>We will create our Elm application under the folder <strong>packages/elm-app/app</strong>.</p>
</div>
<div class="paragraph">
<p>We need to install Elm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">meteor npm i -D elm elm-format</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
elm-format is not mandatory but you should use it with your IDE to format on save and to avoid problem at compile time
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then we will initialise our app with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app/packages/elm-app/app
meteor npx elm init</code></pre>
</div>
</div>
<div class="paragraph">
<p>Validate the creation of the <strong>elm.json</strong> file and we are good üëç.</p>
</div>
<div class="paragraph">
<p>At this step, your folder should be like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app
‚ùØ tree -I 'node_modules|.meteor' -a
.
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ .meteorignore
‚îú‚îÄ‚îÄ client
‚îÇ   ‚îú‚îÄ‚îÄ main.css
‚îÇ   ‚îú‚îÄ‚îÄ main.html
‚îÇ   ‚îî‚îÄ‚îÄ main.ts
‚îú‚îÄ‚îÄ imports
‚îÇ   ‚îî‚îÄ‚îÄ api
‚îú‚îÄ‚îÄ package-lock.json
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ packages
‚îÇ   ‚îî‚îÄ‚îÄ elm-app
‚îÇ       ‚îú‚îÄ‚îÄ app
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ elm.json
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ src
‚îÇ       ‚îú‚îÄ‚îÄ dist
‚îÇ       ‚îî‚îÄ‚îÄ package.js
‚îú‚îÄ‚îÄ server
‚îÇ   ‚îî‚îÄ‚îÄ main.ts
‚îî‚îÄ‚îÄ tsconfig.json

9 directories, 11 files</code></pre>
</div>
</div>
<div class="paragraph">
<p>In a first time, we will create a simple Elm application.</p>
</div>
<div class="paragraph">
<p>Create a <strong>Main.elm</strong> file inside the folder <strong>packages/elm-app/app/src</strong> with this content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-elm" data-lang="elm">module Main exposing(main)

import Browser
import Html exposing (Html, text)

type alias Model = String

main : Program () Model msg
main =
    Browser.element
        { init = init
        , view = view
        , update = update
        , subscriptions = subscriptions
        }

init: () -&gt; (Model, Cmd msg)
init _ =
    ("Hello from Elm app", Cmd.none)

view: Model -&gt; Html msg
view model =
    text model

update: msg -&gt; Model -&gt; (Model, Cmd msg)
update _ model =
    (model, Cmd.none)

subscriptions : Model -&gt; Sub msg
subscriptions _ =
    Sub.none</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_css_main_file">The CSS main file</h3>
<div class="paragraph">
<p>In the folder <strong>meteor-elm-app/packages/elm-app/app</strong>, create an empty <strong>main.scss</strong> SCSS file (or CSS if you prefer) that we will use later to add some style in our Elm application.</p>
</div>
<div class="paragraph">
<p>NB: if you use <strong>elm-css</strong> and you don&#8217;t need a stylesheet, skip this step and remove the line <code>api.addFiles('dist/elm-app.css', 'client');</code> in the <strong>package.js</strong> file</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_package_mainmodule">The Package mainModule</h3>
<div class="paragraph">
<p>In the folder <strong>meteor-elm-app/packages/elm-app/app</strong>, create a file <strong>index.ts</strong> that will <strong>mount</strong> our Elm application and export the <strong>ports</strong>.</p>
</div>
<div class="paragraph">
<p>A simple version could be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import './main.scss'
const { Elm } = require('./src/Main.elm')

export const init = (configuration: any) =&gt; {
    const app = Elm.Main.init(configuration)
    return app.ports
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>But because we want to <strong>Type</strong> things as much as possible, let&#8217;s create this <strong>index.ts</strong> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import './main.scss'
const { Elm } = require('./src/Main.elm')

interface Flags {}

export interface Configuration {
    node: HTMLElement | null,
    flags: Flags
}

export interface Ports {}

export const init: (configuration: Configuration) =&gt; Ports = (configuration) =&gt; {
    const app = Elm.Main.init(configuration)
    return app.ports
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this definition, when we will need some flags or some ports, we will add the new stuff in our interface and the client will have to implement them.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using <strong>CSS</strong> instead of <strong>SCSS</strong> then update the file import accordingly
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_build_with_parcel">Build with Parcel</h3>
<div class="paragraph">
<p>Let&#8217;s create a build script in our <strong>package.json</strong> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"elm:build": "parcel build packages/elm-app/app/index.ts -d packages/elm-app/dist --out-file elm-app.js --no-cache",</code></pre>
</div>
</div>
<div class="paragraph">
<p>This script will build our application in a file <strong>elm-app.js</strong> (and <strong>elm-app.css</strong>) and put it in the folder <strong>packages/elm-app/dist</strong> (the one we added in our <strong>.gitignore</strong>)</p>
</div>
<div class="paragraph">
<p>We can test our script</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app
meteor npm run elm:build</code></pre>
</div>
</div>
<div class="paragraph">
<p>If everything is ok, you should see these lines:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84450020-4ea43680-ac4f-11ea-9b45-ce0dfb572835.png" alt="84450020 4ea43680 ac4f 11ea 9b45 ce0dfb572835">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_our_package_to_meteor">Add our package to Meteor</h3>
<div class="paragraph">
<p>Now that we have a package, we have to add it in our <a href="https://www.meteor.com/">Meteor</a> configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
you must have run the previous build command before adding the package because without a dist folder, you will not be able to add it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Execute this command to add the package</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app
meteor add elm-app</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84450082-7abfb780-ac4f-11ea-92f4-db936ee6f726.png" alt="84450082 7abfb780 ac4f 11ea 92f4 db936ee6f726">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_post_install">Post install</h3>
<div class="paragraph">
<p>To avoid to have to compile manually each time someone clone the repository, we will add a <code>postinstall</code> script in the <strong>package.json</strong> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"postinstall": "meteor npm run elm:build",</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_the_elm_application_in_our_meteor_client">Use the Elm application in our Meteor client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have our Elm application, it is time to import it in the client side of our <a href="https://www.meteor.com/">Meteor</a> application</p>
</div>
<div class="paragraph">
<p>In the <strong>client/main.ts</strong> file, add the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { init } from "meteor/elm-app";
import { Meteor } from 'meteor/meteor';

Meteor.startup(() =&gt; {
    const ports = init({
        node: document.getElementById("main"),
        flags: {}
    })
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this code, we import the <code>init</code> function from the package <code>meteor/elm-app</code> which is the package we have just created (you can see it in the file <strong>.meteor/packages</strong>).
Then we call it to mount our Elm application on the node <code>document.getElementById("main")</code> (the one we have created in the <strong>main.html</strong> file)</p>
</div>
<div class="paragraph">
<p>Now, if you start your meteor application by running the <code>meteor</code> command, on <a href="http://localhost:3000" class="bare">http://localhost:3000</a> you should see:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84450699-4a791880-ac51-11ea-9c51-c0046cc273a0.png" alt="84450699 4a791880 ac51 11ea 9c51 c0046cc273a0">
</div>
</div>
<div class="paragraph">
<p>But&#8230;&#8203;</p>
</div>
<div class="sect2">
<h3 id="_the_typing_is_not_good">The typing is not good</h3>
<div class="paragraph">
<p>You should see that your import is underlined in red:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84450825-9c21a300-ac51-11ea-9243-78a13ecad82d.png" alt="84450825 9c21a300 ac51 11ea 9243 78a13ecad82d">
</div>
</div>
<div class="paragraph">
<p>To fix that, we will add a declaration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app
mkdir -p types/meteor
touch types/meteor/elm-app.d.ts</code></pre>
</div>
</div>
<div class="paragraph">
<p>And add the following content</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">declare module 'meteor/elm-app' {
    export const init: (
        configuration: import('/packages/elm-app/app').Configuration,
    ) =&gt; import('/packages/elm-app/app').Ports;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now each time we will change the definition of the type <code>Flag</code> or the type <code>Port</code> inside our Elm application, we will be sure to know if we have some stuff to fix in the <a href="https://www.meteor.com/">Meteor</a> client üí™.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_live_reload">Live Reload</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because we don&#8217;t want to build manually our Elm application each time we make a change, we will setup the live reload</p>
</div>
<div class="paragraph">
<p>We will install some packages to help us</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app
meteor npm i -D concurrently wait-on rimraf</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we will create an new script in our <strong>package.json</strong> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"elm:watch": "parcel watch packages/elm-app/app/index.ts -d packages/elm-app/dist --out-file elm-app.js",</code></pre>
</div>
</div>
<div class="paragraph">
<p>With <code>elm:watch</code>, parcel will rebuild our app each time we make a change in Elm, TS or SCSS files under the folder <strong>packages/elm-app/app</strong>.</p>
</div>
<div class="paragraph">
<p>And because <code>parcel watch</code> create a <strong>.cache</strong> folder, we will add it to the <strong>.gitignore</strong> file.
The content of your <strong>.gitignore</strong> should be like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>node_modules/
dist
elm-stuff
.cache</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now to run parcel and meteor in parallel, we will update the <strong>package.json</strong> file.
We will rename the script <code>start</code> to <code>meteor:run</code>, and redefine the script <code>start</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"meteor:run": "meteor run",
"start": "rimraf \"./packages/elm-app/dist/*\" &amp;&amp; concurrently -n \"parcel,meteor\" -c \"magenta,green\" \"meteor npm run elm:watch\" \"wait-on ./packages/elm-app/dist/elm-app.js &amp;&amp; meteor npm run meteor:run\"",</code></pre>
</div>
</div>
<div class="paragraph">
<p>The script <code>start</code> call <code>rimraf</code> to clean the <strong>dist</strong> folder, then we call <code>concurrently</code> to run two tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>parcel</code> one, that will be log in <code>magenta</code> and its command is <code>meteor npm run elm:watch</code></p>
</li>
<li>
<p>the <code>meteor</code> one, that will be log in <code>green</code> and its command is <code>wait-on ./packages/elm-app/dist/elm-app.js &amp;&amp; meteor npm run meteor:run</code> (the <code>wait-on</code> command is use to wait the build from Parcel)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now each time we will change our content under <strong>packages/elm-app/app</strong>, <a href="https://parceljs.org/">Parcel</a> will rebuild incrementally our application and update the content under the <strong>dist</strong> folder, so <a href="https://www.meteor.com/">Meteor</a> will detect a change and refresh the main application.</p>
</div>
<div class="paragraph">
<p>You can now start your application by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app
meteor npm start</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can make some changes in your <code>Main.elm</code> file and see that everything will automatically refresh in your browser.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tailwindcss">Tailwindcss</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tailwindcss is a npm package, so we will install it like this</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">meteor npm i -D tailwindcss</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more informations about Tailwindcss, see <a href="https://tailwindcss.com/docs/installation" class="bare">https://tailwindcss.com/docs/installation</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We need to initialize Tailwincss:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app/packages/elm-app/app
meteor npx tailwindcss init</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will generate a file called <strong>tailwind.config.js</strong></p>
</div>
<div class="paragraph">
<p>We can now edit the file <strong>main.scss</strong> inside our app (packages/elm-app/app/main.scss) to use <a href="https://tailwindcss.com/">Tailwindcss</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-css" data-lang="css">@tailwind base;
@tailwind components;
@tailwind utilities;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We will configure <strong>postcss</strong> to use <strong>autoprefixer</strong> and the <strong>tailwind.config.js</strong> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app/packages/elm-app/app
touch postcss.config.js</code></pre>
</div>
</div>
<div class="paragraph">
<p>And add this content to this file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">const path = require("path");

module.exports = {
  plugins: [
    require("tailwindcss")(path.join(__dirname, "tailwind.config.js")),
    require("autoprefixer"),
  ],
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now edit our <strong>Main.elm</strong> to add a CSS class (<code>text-green-500</code>) from Tailwindcss:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>view: Model -&gt; Html msg
view model =
    div [class "text-green-500"] [text model]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then if you (re)start your server, you should see this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84566211-bfdb0b00-ad6f-11ea-86fa-927a901ae327.png" alt="84566211 bfdb0b00 ad6f 11ea 86fa 927a901ae327">
</div>
</div>
<div class="paragraph">
<p>Congratulations üéâ! You made your first application with Elm, <a href="https://www.meteor.com/">Meteor</a> and Tailwindcss üëè.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_todos_application">The Todos application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is really awesome right? What? You don&#8217;t want to use <a href="https://www.meteor.com/">Meteor</a> just to expose static file? Hmm ok, let&#8217;s go with the Todos application</p>
</div>
<div class="paragraph">
<p>Because the goal of this post is not to learn how to code in Elm, we will start with an application I wrote for the occasion.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://user-images.githubusercontent.com/2006548/84833215-132eb100-b02f-11ea-836b-63a14a6dbe74.png" alt="84833215 132eb100 b02f 11ea 836b 63a14a6dbe74">
</div>
</div>
<div class="paragraph">
<p>This application is not linked with <a href="https://www.meteor.com/">Meteor</a> yet, there is no ports defined.
The goal is to save each Todo in MongoDB and to be able to sync two browser.</p>
</div>
<div class="sect2">
<h3 id="_update_the_main_elm">Update the Main.elm</h3>
<div class="paragraph">
<p>Replace the content of the Main.elm file with this gist <a href="https://gist.github.com/anthonny/1b6a73782a6ad94c611849b9a5d4cbbf" class="bare">https://gist.github.com/anthonny/1b6a73782a6ad94c611849b9a5d4cbbf</a></p>
</div>
<div class="paragraph">
<p>We will need to add <code>elm/svg</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app/packages/elm-app/app
meteor npx elm install elm/svg</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then start your application</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>meteor npm start</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can try the application, actually we can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a Todo</p>
</li>
<li>
<p>Switch the status of a Todo</p>
</li>
<li>
<p>Filter Todos by status</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will keep the filtering part in the client, but we want to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Load Todos from MongoDB</p>
</li>
<li>
<p>Save new Todos in MongoDB</p>
</li>
<li>
<p>Switch the status and save it in MongoDB</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But let&#8217;s start with the backend</p>
</div>
</div>
<div class="sect2">
<h3 id="_define_the_todos_collection_and_methods">Define the Todos collection and methods</h3>
<div class="paragraph">
<p>Under the folder <strong>meteor-elm-app/imports/api</strong>, create a file <strong>todos.ts</strong>.</p>
</div>
<div class="paragraph">
<p>In this file we will define what is a Todo, and create the collection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Mongo } from "meteor/mongo";
import { Meteor } from "meteor/meteor";

export interface Todo {
  _id?: string;
  value: string;
  status: "checked" | "unchecked";
  createdAt: Date;
}

export const TodosCollection = new Mongo.Collection&lt;Todo&gt;("todos");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then in the same file, we will add two <a href="https://www.meteor.com/">Meteor</a> methods, one to add a Todo and another to switch the status of Todo with its ID:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">Meteor.methods({
  "todos.addTodo"(value: string) {
    if (value !== "") {
      TodosCollection.insert({
        value,
        status: "unchecked",
        createdAt: new Date(),
      });
    }
  },
  "todos.toggleStatus"(todoId: string) {
    const todo = TodosCollection.findOne({ _id: todoId });
    if (!todo) {
      throw new Meteor.Error("Todo not found");
    }

    const newStatus = todo.status === "checked" ? "unchecked" : "checked";

    TodosCollection.update({ _id: todoId }, { $set: { status: newStatus } });
  },
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>And at the end of the file, we will publish our collection on the server side:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">if (Meteor.isServer) {
  Meteor.publish("todos", function todos() {
    return TodosCollection.find({}, { sort: { createdAt: -1 } });
  });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally we need to import this file in the file <strong>server/main.ts</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import "/imports/api/todos";</code></pre>
</div>
</div>
<div class="paragraph">
<p>The server side in now ready.</p>
</div>
</div>
<div class="sect2">
<h3 id="_add_ports_to_the_elm_application">Add ports to the Elm application</h3>
<div class="paragraph">
<p>We will start by installing <code>elm/json</code> and <code>NoRedInk/elm-json-decode-pipeline</code> to decode our Todos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">#under meteor-elm-app/packages/elm-app/app
meteor npx elm install elm/json
meteor npx elm install NoRedInk/elm-json-decode-pipeline</code></pre>
</div>
</div>
<div class="paragraph">
<p>So we will create 3 ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>addTodo: <code>port addTodo : String &#8594; Cmd msg</code></p>
</li>
<li>
<p>toggleStatus: <code>port toggleStatus : String &#8594; Cmd msg</code></p>
</li>
<li>
<p>receiveTodos: <code>port receiveTodos : (Decode.Value &#8594; msg) &#8594; Sub msg</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s put these port at the end of our <strong>Main.elm</strong> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-elm" data-lang="elm">port module Main exposing(main)

import Json.Decode as Decode
import Json.Decode.Pipeline exposing (required)

...

port addTodo : String -&gt; Cmd msg

port toggleStatus : String -&gt; Cmd msg

port receiveTodos : (Decode.Value -&gt; msg) -&gt; Sub msg</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have to change the type of the Todo.id to use a <code>String</code> because of the id in Mongo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-elm" data-lang="elm">type alias Todo =
    { id : String
    , value : String
    , status : TodoStatus
    }

type Msg
    = InputChanged String
    | AddTodo
    | ToggleStatus String -- ToggleStatus now need a String not a Int
    | FilterBy Filter</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need a new variant <code>ReceiveTodos (List Todo)</code> for <code>Msg</code> to receive todos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-elm" data-lang="elm">type Msg
    = InputChanged String
    | AddTodo
    | ToggleStatus String
    | FilterBy Filter
    | ReceiveTodos (List Todo)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We also change the <code>update</code> function because we will not update the <code>todos</code> list anymore.
We will get the one we will receive from the port <code>receiveTodos</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-elm" data-lang="elm">update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )
update msg model =
    case msg of
        InputChanged value -&gt;
            ( { model | todo = value }, Cmd.none )

        AddTodo -&gt;
            if String.isEmpty (String.trim model.todo) then
                ( model, Cmd.none )

            else
                ( { model | todo = "" }, addTodo model.todo )

        ToggleStatus todoId -&gt;
            let
                updateTodo todo =
                    if todo.id == todoId then
                        { todo | status = toggleTodoStatus todo.status }

                    else
                        todo
            in
            ( model, toggleStatus todoId )

        FilterBy selectedFilter -&gt;
            ( { model | filter = selectedFilter }, Cmd.none )

        ReceiveTodos todos -&gt;
            ( { model | todos = todos }, Cmd.none )</code></pre>
</div>
</div>
<div class="paragraph">
<p>To finish with the Elm part, we need a subscription and some decoders to receive our Todos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-elm" data-lang="elm">subscriptions : Model -&gt; Sub Msg
subscriptions _ =
    receiveTodos
        (\value -&gt;
            Decode.decodeValue decodeTodos value
                |&gt; Result.withDefault []
                |&gt; ReceiveTodos
        )


decodeTodo : Decode.Decoder Todo
decodeTodo =
    Decode.succeed Todo
        |&gt; required "id" Decode.string
        |&gt; required "value" Decode.string
        |&gt; required "status" decodeStatus


decodeStatus : Decode.Decoder TodoStatus
decodeStatus =
    Decode.string
        |&gt; Decode.andThen
            (\status -&gt;
                case status of
                    "checked" -&gt;
                        Decode.succeed Checked

                    _ -&gt;
                        Decode.succeed Unchecked
            )


decodeTodos : Decode.Decoder (List Todo)
decodeTodos =
    Decode.list decodeTodo</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you remember, we have defined an interface <code>Ports</code> in the file <strong>meteor-elm-app/packages/elm-app/app/index.ts</strong>.
It is time to add some definitions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">interface Todo {
  id: string;
  value: string;
  status: "checked" | "unchecked";
}

export interface Ports {
  addTodo?: {
    subscribe: (fn: (todo: string) =&gt; void) =&gt; void;
  };
  toggleStatus?: {
    subscribe: (fn: (todoId: string) =&gt; void) =&gt; void;
  };
  receiveTodos?: {
    send: (todos: Todo[]) =&gt; void;
  };
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_link_ports_to_meteor_methods_and_subscriptions">Link ports to Meteor.methods and subscriptions</h3>
<div class="paragraph">
<p>We have some piece of code in Elm and some piece of code in the server side.
Now we need to link them together, and we will do that in the file <strong>client/main.ts</strong></p>
</div>
<div class="paragraph">
<p>We will need to import our TodosCollection and the <a href="https://www.meteor.com/">Meteor</a> Tracker</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">import { Tracker } from "meteor/tracker";
import { TodosCollection } from "/imports/api/todos";</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we will subscribe to the output ports:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">  ports.addTodo?.subscribe((todo) =&gt; {
    Meteor.call("todos.addTodo", todo, (err: Error) =&gt; {
      if (err) {
        // Maybe we should pass this error to Elm
        console.log("error", err);
        return;
      }
    });
  });

  ports.toggleStatus?.subscribe((todoId) =&gt; {
    Meteor.call("todos.toggleStatus", todoId, (err: Error) =&gt; {
      if (err) {
        // Maybe we should pass this error to Elm
        console.log("error", err);
        return;
      }
    });
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here each time <code>addTodo</code> is called from Elm, we add a new Todo with a Meteor.call, same for the toggleStatus.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Of course we should manage the error, maybe it could be a good exercice üòÅ
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally we need to send todos everytime the collection change.
To do that, we use <code>Tracker.autorun</code> that will run the callback when necessary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ts" data-lang="ts">  // We use the Tracker.autorun to send todos each time the fetch result
  // changes
  Tracker.autorun(() =&gt; {
    // Maybe one day we will need to manage the subscription
    const subscription = Meteor.subscribe("todos");

    const todos = TodosCollection.find({}, { sort: { createdAt: 1 } }).fetch();

    ports.receiveTodos?.send(
      todos.map((todo) =&gt; ({
        id: todo._id || "",
        value: todo.value,
        status: todo.status,
      }))
    );
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can restart your server, open two browsers on <a href="http://localhost:3000" class="bare">http://localhost:3000</a> and see that everything is saved and sync üëè.</p>
</div>
<div class="videoblock">
<div class="content">
<video src="https://anthonnyquerouil.me/images/todo-elm-meteor.mp4" width="100%" controls>
Your browser does not support the video tag.
</video>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I hope you enjoyed this content as much as I enjoyed writing it.
Three weeks ago I was sad because I could not use <a href="https://www.meteor.com/">Meteor</a> with {url-elm}[Elm], so I started using it with React and Typescript üò≥.</p>
</div>
<div class="paragraph">
<p>Today, I dropped React and I use Elm again and it is really pleasant.</p>
</div>
<div class="paragraph">
<p>If you liked this post, do not hesitate to share it on your favorite social networks and if you are interested by this kind of content, you can follow me on twitter <a href="https://twitter.com/anthonny_q">@anthonny_q</a>.</p>
</div>
<div class="paragraph">
<p>If you have any feedbacks, comments are open and you can find the sources of the project here <a href="https://github.com/anthonny/meteor-elm-app" class="bare">https://github.com/anthonny/meteor-elm-app</a>.</p>
</div>
<div class="paragraph">
<p>Special thanks to <a href="https://forums.meteor.com/u/ni-ko-o-kin">ni-ko-o-kin</a>, as I was very inspired by his <a href="https://forums.meteor.com/t/meteor-elm-example/50244">post</a>.</p>
</div>
<div class="paragraph">
<p>Big thanks to <a href="https://twitter.com/yanndanthu">Yann Danthu</a> for the review of this post üòò.</p>
</div>
</div>
</div>
          </div>
          <footer class="post-footer">
            <div itemprop="author" itemscope itemtype="http://schema.org/Person" class="post-author">
                <a href="http://www.anthonnyquerouil.fr" class="post-author-avatar">
                  <img itemprop="image" src="https://avatars1.githubusercontent.com/u/2006548?v&#x3D;4" alt="Anthonny Qu√©rouil">
                </a>
              <div class="post-author-info">
                <h4 class="post-footer-heading">Written By</h4>
                <a href="http://www.anthonnyquerouil.fr" itemprop="url" class="post-author-name">
                  <span itemprop="name">Anthonny Qu√©rouil</span>
                </a>
                <p itemprop="description" class="post-author-bio"></p>
                  <p class="post-author-location">Nantes, France</p>
                  <p class="post-author-website">
                    <a href="http://www.anthonnyquerouil.fr" rel="nofollow">http://www.anthonnyquerouil.fr</a>
                  </p>
                <p class="post-info">
                  <b class="post-info-title">Published on</b>
                  <time class="post-date">June 17, 2020</time>
                </p>
              </div>
            </div>
            <div class="post-social">
              <h4 class="post-footer-heading">Spread the word</h4>
              <a href="#" data-action="share-twitter"><i class="fa fa-fw fa-lg fa-twitter"></i></a>
              <a href="#" data-action="share-facebook"><i class="fa fa-fw fa-lg fa-facebook"></i></a>
              <a href="#" data-action="share-gplus"><i class="fa fa-fw fa-lg fa-google-plus"></i></a>
            </div>
          </footer>
        </section>

      <section class="post-comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
        var disqus_shortname = 'anthonnyquerouil'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </section>

    </article>

    <footer role="contentinfo" class="footer">
      <p><small>¬© 2020. All Rights Reserved.</small></p>
      <p><small><a href="http://ghostium.oswaldoacauan.com/" target="_blank">Ghostium Theme</a> by <a href="http://twitter.com/oswaldoacauan" target="_blank">@oswaldoacauan</a></small></p>
      <p><small>Proudly published with <a href="https://hubpress.github.io" target="_blank">HubPress</a></small></p>
    </footer>
  </div>
</section>


          </div>
        </div>
      </div>
    </main>


    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/prism.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        // hljs.initHighlightingOnLoad();
      </script>

    <script src="//anthonnyquerouil.me/themes/ghostium/assets/js/foot-scripts.min.js?v=1592393711943"></script>



    <!-- Fathom - beautiful, simple website analytics -->
    <script src="https://cdn.usefathom.com/3.js" site="RMDAJFGG"></script>
    <!-- / Fathom -->
  </body>
</html>
